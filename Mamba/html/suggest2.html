<html>	
<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <script type="text/javascript" src="../js/jquery-1.10.1.js"></script>
    
    <script type="text/javascript" src="../js/MbaError.js"></script>
	<script type="text/javascript" src="../js/Mamba.js"></script>
	<script type="text/javascript" src="../js/MbaUtil.js"></script>
	<script type="text/javascript" src="../js/MbaDom.js"></script>
    <script type="text/javascript" src="../js/MbaDomSingle.js"></script>
    <script type="text/javascript" src="../js/MbaDomFromString.js"></script>
    <script type="text/javascript" src="../js/MbaDomEmpty.js"></script>
    <script type="text/javascript" src="../js/MbaAnchor.js"></script>
    <script type="text/javascript" src="../js/MbaDirective.js"></script>
    <script type="text/javascript" src="../js/MbaRootDirective.js"></script>
    <script type="text/javascript" src="../js/AnchorProvider.js"></script>
    <script type="text/javascript" src="../js/DefaultAnchorProvider.js"></script>
    <script type="text/javascript" src="../js/TextNodeAnchorProvider.js"></script>    
    <script type="text/javascript" src="../js/MbaBinding.js"></script>
	<script type="text/javascript" src="../js/MbaBindingText.js"></script>		
    <script type="text/javascript" src="../js/MbaAccessor.js"></script>
    <script type="text/javascript" src="../js/MbaAccessorChain.js"></script>
    <script type="text/javascript" src="../js/MbaTransf.js"></script>
    <script type="text/javascript" src="../js/EventConnector.js"></script>
    <script type="text/javascript" src="../js/EventConnectorTextNode.js"></script>
    <script type="text/javascript" src="../js/MbaTextTransf.js"></script>
    <script type="text/javascript" src="../js/MbaAttributeTransf.js"></script>
    <script type="text/javascript" src="../js/MbaClassTransf.js"></script>
    <script type="text/javascript" src="../js/MbaClassWithArgTransf.js"></script>
    <script type="text/javascript" src="../js/MbaRefFunctionTransf.js"></script>
    <script type="text/javascript" src="../js/MbaCustomFunctionTransf.js"></script>
    <script type="text/javascript" src="../js/MbaPropertyTransf.js"></script>
    <script type="text/javascript" src="../js/MbaRoute.js"></script>
    <script type="text/javascript" src="../js/MbaNode.js"></script>
    <script type="text/javascript" src="../js/MbaNodeDirective.js"></script>
    <script type="text/javascript" src="../js/MbaRootNode.js"></script>
    <script type="text/javascript" src="../js/MbaTemplate.js"></script>
    <script type="text/javascript" src="../js/MbaTemplateDebug.js"></script>
    <script type="text/javascript" src="../js/MbaNodeHtmlElement.js"></script>
    <script type="text/javascript" src="../js/MbaNodeBinding.js"></script>
    <script type="text/javascript" src="../js/MbaNodeConstructor.js"></script>
	<script type="text/javascript" src="../js/MbaVisitor.js"></script>
    <script type="text/javascript" src="../js/MbaDirectiveVisitor.js"></script>
    <script type="text/javascript" src="../js/MbaDirectiveDebugVisitor.js"></script>
    <script type="text/javascript" src="../js/AddTextNodesVisitor.js"></script>
    <script type="text/javascript" src="../js/MbaTemplateDirective.js"></script>
    <script type="text/javascript" src="../js/MbaTemplateBinding.js"></script>
    <script type="text/javascript" src="../js/TemplateDirectiveConstructorVisitor.js"></script>
    <script type="text/javascript" src="../js/MbaTemplateDirectiveVisitor.js"></script>
    <script type="text/javascript" src="../js/MbaTemplateDirectiveDebugVisitor.js"></script>
    <script type="text/javascript" src="../js/MbaNodeVisitor.js"></script>
    <script type="text/javascript" src="../js/DebugNodeVisitor.js"></script>
    <script type="text/javascript" src="../js/TestNodeVisitor.js"></script>
    <script type="text/javascript" src="../js/IntegrateBindingAndDirectiveNodesVisitor.js"></script>
    <script type="text/javascript" src="../js/DirectiveSplitter.js"></script>
    <script type="text/javascript" src="../js/DirectiveValueParser.js"></script>
    <script type="text/javascript" src="../js/DirectiveValueParserDebug.js"></script>
    <script type="text/javascript" src="../js/DirectiveExtractor.js"></script>
    <script type="text/javascript" src="../js/BaseExtractor.js"></script>
    <script type="text/javascript" src="../js/SimpleExtractor.js"></script>
    <script type="text/javascript" src="../js/AttributeExtractor.js"></script>
    <script type="text/javascript" src="../js/ClassExtractor.js"></script>
    <script type="text/javascript" src="../js/PropertyExtractor.js"></script>
    <script type="text/javascript" src="../js/ClassWithArgExtractor.js"></script>
    <script type="text/javascript" src="../js/RefFunctionExtractor.js"></script>
    <script type="text/javascript" src="../js/CustomFunctionExtractor.js"></script>
    <script type="text/javascript" src="../js/MbaConnectEventsVisitor.js"></script>
    <script type="text/javascript" src="../js/DebugNodeAndAccessorVisitor.js"></script>
    <script type="text/javascript" src="../js/MbaActionBinding.js"></script>
    <script type="text/javascript" src="../js/AddActionBindingIntoNodesVisitor.js"></script>
    <script type="text/javascript" src="../js/UpdateSuperModelReferenceVisitor.js"></script>   
    <script type="text/javascript" src="../js/GetNodesAndAccessorsVisitor.js"></script>   
    <script type="text/javascript" src="../js/AccessorChainAndMbaNodes.js"></script>       
    <script type="text/javascript" src="../js/RootAccessorNode.js"></script>   
    <script type="text/javascript" src="../js/AccessorNode.js"></script>   
    <script type="text/javascript" src="../js/CheckIndexedRenderedDomVisitor.js"></script> 
    <script type="text/javascript" src="../js/MbaModelExplorer.js"></script> 
    <script type="text/javascript" src="../js/MbaModelFinder.js"></script> 
    <script type="text/javascript" src="../js/MbaRefreshMethodGenerator.js"></script>
  
    <style type="text/css">
		body
        {
            height :100%; 
            text-align: center;
        }
        .option {
            visibility: hidden;
        }
        .option:hover{
            cursor: pointer;
        }
        .visible {
            visibility: visible;
        }
	</style>
</head>

<body>
</body>
<script type="text/javascript">
        
    /*var html = '<select><option></option></select>';    
    var model = function() {
        this.données  = [{code: 1, lib: 'pouet'},
                         {code: null, lib: 'veuillez choisir'},
                         {code: 2, lib: 'poulou'}];
        this.choix = null;
    };
    var directive = {
        "données": {
            "r00t": "option",
            "code": "option$value",
            "lib": "option"
        },
        "choix": "select$value->change"
    };
    
    var mamba = new Mamba(new model(), html, directive, 'body');
    mamba.render();*/
    function Option(code, libellé){
        this.code = code;
        this.libellé = libellé;   
        this.visible = false;
    };
    
    function Select(options, codeSélectionné){
        this.options;
        this.valeur;
        this.valeursVisibles = false;
        
        this.init = function(options, codeSélectionné){
            this.créerLesOptions(options);
            this.valeur = this.trouverLOption(codeSélectionné);
        };
        
        this.créerLesOptions = function(options){
            this.options = [];
            for(var i=0 ; i<options.length ; i++){
                var currOption = options[i];
                this.options.push(new Option(currOption.code, currOption.lib));
            }    
        };
        
        this.trouverLOption = function(code){
            for(var i=0 ; i<this.options.length ; i++){
                var currOption = this.options[i];
                if(this.options[i].code == code)
                    return currOption;
            }
            return null;
        };
        
        this.sélectionner = function(option){
            console.log('select', option);
            this.valeur = option;
        };
        
        this.toggle = function(){
            this.valeursVisibles = !this.valeursVisibles;
            for(var i=0 ; i<this.options.length ; i++){
                this.options[i].visible = this.valeursVisibles;
            }
        };
        
        this.init(options, codeSélectionné);
    };
    
    
    var html = '<span class="select"></span><button>V</button><div class="option"></div>';    
    var model = new Select([{code: 1, lib: 'toto'},
                            {code: 2, lib: 'tutu'},
                            {code:3, lib: 'titi'}], 1);
    var directive = 
        {'valeur' : {'libellé': 'span'},
         'options' : {'r00t' : '.option',
                      'libellé' : '.option',
                      'visible' : '.option@class(visible)'},
         '/toggle': 'button->click',
         '/sélectionner': '.option->click'
        };
    
    var mamba = new Mamba(model, html, directive, 'body');
    mamba.render();
</script>
</html>
